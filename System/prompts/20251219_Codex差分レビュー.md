# Codex-差分レビュー-リファクタリング提案

## 使用タイミング
- Claude Code / Cursor で実装後、コミット/PR前に差分レビューしたい
- 「サンプル（CSV/Excel）はGit管理しない」前提で、混入チェックもしたい

## プロンプト本文
あなたはシニアエンジニア兼レビュアーです。以下を**短く・具体的に**行ってください。

1. まず `git status` と `git diff --staged` を実行して差分を把握する（ステージ差分が無い場合は `git diff`）
   - 推奨運用: 変更がまとまるたびに `git add -p` で意図した差分だけステージし、`git diff --staged` をレビュー対象にする（WIPは未ステージのままでOK）
2. 変更の意図を1〜2行で要約する
3. 指摘は優先度順（P0/P1/P2）で、各項目に以下を含める
   - 理由（何が問題か）
   - 具体的な修正案（可能ならパッチ/擬似コード）
   - 影響範囲（どこが壊れうるか）
   - 確認手順（どう確認するか）
4. 新規/更新ファイルは、命名・配置・責務の妥当性も確認する
5. **運用ルール**: `samples/` と `deliverables/`（およびCSV/XLSX等の実データ）はコミットしない
   - 差分に含まれていたら、混入原因の推測と、`.gitignore` 提案、`git rm --cached` 等の除外手順まで提示する
6. 可能なら軽いリファクタリング提案（重複削減、責務分離、エラー処理、命名、テストしやすさ）を出す（過剰な改変は避ける）
7. 最後に「このまま進めて良いか」を **Yes/No（条件付き可）**で結論する

制約:
- 既存仕様を壊さない
- 不要な大規模リネーム/全体フォーマット変更はしない
- ネットワークアクセスしない

## 使用例
「いまのブランチの差分をレビューして、バグ/運用事故（サンプル混入）/改善点を指摘して」

## 期待される結果
- 変更要約 + 優先度付きレビュー指摘
- サンプル/成果物のGit混入チェック
- 具体的な修正案と確認手順

## 注意事項
- 指摘だけで終わらず、実行できる次アクション（コマンド/手順）まで書く
- 仕様が不明な点は推測せず、質問として分離する

## 関連プロンプト
- [[20250113_万能機能追加プロンプト]]
- [[20250113_npm-test解決プロンプト]]
